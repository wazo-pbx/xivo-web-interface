#! /bin/bash
# postinst script for xivo-web-interface
#
# see: dh_installdeb(1)

WEBI_LOG="/var/log/xivo-web-interface"

case "$1" in
	configure)
		previous_version="$2"

		chown -R www-data:www-data ${WEBI_LOG}

		if [[ -z "${previous_version}" ]]; then
			ln -sf /etc/nginx/locations/http-available/xivo-web-interface \
			       /etc/nginx/locations/http-enabled/xivo-web-interface
			ln -sf /etc/nginx/locations/https-available/xivo-web-interface \
			       /etc/nginx/locations/https-enabled/xivo-web-interface
		fi

		if [ -x /etc/init.d/spawn-fcgi ]; then
			invoke-rc.d spawn-fcgi restart
		fi
	;;
	abort-upgrade|abort-remove|abort-deconfigure)

	;;

	*)
		echo "postinst called with unknown argument \`$1'" >&2
		exit 1
	;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
